<!DOCTYPE html>
<html lang="en"></html>
<html>

<head>
    <title>Jambo - Join the Event</title>
    <link rel="stylesheet" href="css/join.css">
    <script src="https://kit.fontawesome.com/a7b9dfbf73.js" crossorigin="anonymous"></script>
</head>

<body>
    <div class="navbar">
        <a href="home.html" class="logo" aria-label="Jambo Home">Jambo</a>
        <a class="active" href="#home" aria-label="Login">Login</a>
        <a href="" class="chat_btn" aria-label="Chat">
            <i class="fa fa-commenting-o"></i>
        </a>
        <div class="search-container">
            <input type="text" placeholder="Search..." name="search" aria-label="Search">
        </div>
        <a href="#news" aria-label="Groups">Groups</a>
        <a href="event.html" aria-label="Events">Events</a>
    </div>
    <h1 class="main-title">Join the Event</h1>
    <div class="event-detail">
        <h2 id="eventName" class="event-name"></h2>
        <form id="joinForm" class="form" aria-label="Join Event Form">
            <label for="name">Name:</label>
            <input type="text" id="name" name="name" required aria-required="true"><br>
            <label for="email">Email:</label>
            <input type="email" id="email" name="email" required aria-required="true"><br>
            <label for="phone">Phone:</label>
            <input type="tel" id="phone" name="phone" required aria-required="true"><br>
            <button type="submit" class="submit-btn" aria-label="Submit Join Form">Submit</button>
        </form>
    </div>

    <script>
        // Retrieve the value from the session storage
        var storedName = sessionStorage.getItem('event_name');
        document.getElementById('eventName').innerText = storedName;

        // Handle form submission
        document.getElementById('joinForm').addEventListener('submit', function (event) {
            event.preventDefault(); // Prevent the default form submission
            const postCommunityEventMethod = 'POST';

            // Collect form data
            var formdata = new FormData();
            formdata.append("name", document.getElementById('name').value);
            formdata.append("location", "Morningside Forest");
            formdata.append("organiser", "Morningside Community Wellness Collective");
            formdata.append("event_type", "Group Activity");
            formdata.append("description", "Doing yoga in a tree");
            formdata.append("date_time", "2023-10-21 17:30");
            formdata.append("website_code", "Pete123");
            const baseURL = "https://damp-castle-86239-1b70ee448fbd.herokuapp.com/decoapi/community_events/";
            const requestOptions = {
                method: postCommunityEventMethod,
                body: formdata,
                redirect: 'follow'
            };
            // Send POST request to API
            fetch(baseURL, requestOptions)
                .then(response => response.text())
                .then(result => {
                    alert(result);
                    console.log(result);
                })
                .catch(error => {
                    console.log('error', error);
                    alert('An error occurred. Please try again.');
                });
        });
    </script>
</body>

</html>
